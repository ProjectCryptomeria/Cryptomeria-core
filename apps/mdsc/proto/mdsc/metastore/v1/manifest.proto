syntax = "proto3";
package mdsc.metastore.v1;

option go_package = "mdsc/x/metastore/types";
import "gogoproto/gogo.proto";

// 1. Leaf layer: where each fragment is stored
message FragmentLocation {
  string fdsc_id = 1;
  string fragment_id = 2;
}

// 2. Middle layer: metadata per file
// NOTE: Field numbers are kept stable for existing fields.
// - mime_type (1)
// - size (2)  (was file_size)
// - fragments (3)
// - file_root (4)
message FileInfo {
  string mime_type = 1;
  uint64 size = 2;
  repeated FragmentLocation fragments = 3;
  string file_root = 4; // Merkle root of fragments in this file
}

// 3. Top layer: project manifest stored in MDSC
//
// CSU alignment notes:
// - GWC's IBC ManifestPacket carries (root_proof, fragment_size, owner, session_id).
// - MDSC stores the same identity/verification information here for later querying.
message Manifest {
  string project_name = 1;
  string version = 2;

  // identity
  string owner = 3;
  map<string, FileInfo> files = 4;

  // CSU verification fields
  string root_proof = 5;
  string session_id = 6;
  uint64 fragment_size = 7;
}

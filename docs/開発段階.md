# 🗺️ RaidChain 開発ロードマップ & 進捗状況

本プロジェクトは、オフチェーンでの実験から始まり、段階的に機能をオンチェーン（ブロックチェーン上）へと移行させるアプローチをとっています。
以下に各開発段階の目標と、現在の実装状況（PoCとしての到達点）を定義します。

---

## 🏗️ Stage 1: ファイル分割と分散アップロード機能の実装

* **ステータス**: [開発完了] ✅
* **担当レイヤー**: Controller (TypeScript) / Client Side

### [最低限目標]
* 大容量ファイルを「チャンク」と呼ばれる小さな断片に分割できること。
* 分割されたデータを複数のストレージノードへ送信できること。
* データの構成情報（マニフェスト）を記録し、後から復元できること。

### [概要]
要件定義にある「コントローラー」を具体的に実装するステップ。初期段階ではブロックチェーンの複雑なロジックを使わず、クライアントサイド（TypeScript）のスクリプトによって、ファイルの分割と各チェーンへのAPIリクエスト発行を行う。

### [実装要約]
* **Controller**: TypeScript製の`ExperimentRunner`および`UploadStrategy`として実装完了。
* **動作**: 「Virtual Mode（ダミーデータ）」および「Real Mode（ファイル）」において、クライアント側でデータをメモリ上で分割し、トランザクションとして送信する基本フローを確立した。
* **差異**: 当初はDataChainへ直接HTTP POSTする想定だったが、現在はGWCを経由するフローが標準となりつつある。

---

## 🚀 Stage 2: トランザクションの動的ルーティング

* **ステータス**: [開発完了] ✅
* **担当レイヤー**: Controller (TypeScript) / Infrastructure

### [最低限目標]
* 各チェーンの負荷状況（Mempoolの滞留数など）を監視できること。
* 空いているチェーンへ優先的にデータを送るなど、送信先を動的に決定できること。

### [概要]
Stage 1のコントローラーを拡張し、スマートなアップロード機能を追加する。単純な順番送信（ラウンドロビン）だけでなく、ネットワークの混雑具合を考慮したルーティングをクライアントサイドで実現する。

### [実装要約]
* **Strategies**: `InfrastructureService`によるチェーン監視機能と、それに基づく`AvailableAllocator`（空き容量重視）、`RandomAllocator`などの戦略クラスを実装済み。
* **差異**: 当初は「コントローラーがルーティングを決定してDataChainへ直接投げる」構想だったが、現在のアーキテクチャでは**GWCがルーターの役割を担う**形へ移行したため、これらの戦略は主に「実験用パラメータ（シミュレーション）」として活用されている。実運用（Stage 3以降）のGWCロジックとは分離している点に注意。

---

## 🔗 Stage 3: 処理のオンチェーン化とIBC活用

* **ステータス**: [開発完了] ✅
* **担当レイヤー**: Blockchain (Go/Cosmos SDK) / GWC-MDSC-FDSC

### [最低限目標]
* **GWC (Gateway Chain)** の実装：ファイルの受け付けと分割をオンチェーンで行う。
* **IBC通信**：GWC、MDSC、FDSC間でのパケット送受信によるデータ連携。
* コントローラーへの依存をなくし、トランザクション発行のみでシステムが自律的に動作すること。

### [概要]
オフチェーン（TypeScript）で行っていた「分割・配送・管理」のロジックを、ブロックチェーン（Go言語）のモジュールとして移植する最重要ステップ。これにより「RaidChain」は真のインターチェーン・アプリケーションとなる。

### [実装要約]
* **Architecture**: `chain/gwc`, `chain/mdsc`, `chain/fdsc` の3チェーン構成を実装済み。
* **Logic**:
    * `GWC`: `MsgUpload`を受信し、Goロジック内で分割(`Sharding`)、IBCパケットによる`FDSC`への並列送信(`Distribution`)を実装。
    * `MDSC`: マニフェスト情報の受信と保存を実装。
    * `FDSC`: バイナリ断片(`Fragment`)の保存を実装。
* **現状**: 基本的な分散保存フローはオンチェーンで完結しているが、FDSCへの振り分けロジックは単純な固定/線形処理となっており、Stage 2で検証した高度なルーティングはまだ移植されていない。

---

## 🌐 Stage 4: PoC Finalization - オンチェーンWebの実現

* **ステータス**: [未着手] 🚧
* **担当レイヤー**: Blockchain (GWC Extension) / Interface

### [最低限目標]
* Webブラウザから直接アクセスして、保存されたWebサイト（HTML/画像）を閲覧できること。
* Zipファイルをアップロードするだけで、ディレクトリ構造を持ったWebサイトが公開できること。
* ユーザーがブロックチェーンを意識せずに利用できるUX（Web 2.0体験）の提供。

### [概要]
PoCの最終仕上げとして、ユーザビリティと「動くデモ」としての完成度を高めるフェーズ。ブロックチェーンの制約（ブロックサイズ等）を一部緩和設定とし、GWCにWebサーバーとしての機能を持たせることで、実際にブラウザで閲覧可能な分散ホスティングを実現する。

### [追加機能]
1.  **Direct Upload**: API経由でのバイナリ直接アップロードと、巨大トランザクションによる一括送信。
2.  **On-chain Unzip**: Zipファイルのアップロードと、GWC内部でのオンチェーン解凍・展開展開。
3.  **Web Server Mode**: GWCにカスタムHTTPハンドラーを実装し、`http://raidchain.com/...` へのアクセスに対し、裏側で全チェーンからデータを集めてWebページをレンダリング（返却）する機能。
4.  **Round-Robin on Chain**: GWCのGoロジックに、複数FDSCへの均等なラウンドロビン振り分けを実装。

---
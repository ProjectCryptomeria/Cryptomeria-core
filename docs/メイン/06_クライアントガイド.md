---
DocType: GUIDE
SourceOfTruth: code
Status: draft
LastReviewed: 2026-01-25
Owners: TBD
---

# Client Guide（利用者向け）

## 1. この文書の目的
Cryptomeria-Core を「使う」人のための最短ガイドです。  
（運用者/開発者向けの詳細は Deploy Guide / Runbook を参照）

## 2. 利用者が得られるもの
- 指定 project/version/path のデータを **復元して取得**
- Webホスティング相当の HTTP 取得（/render）

## 3. 事前条件
- システムが起動し、IBC接続と endpoint 登録が完了していること（`just start-system`）
- 取得対象の manifest/fragment が保存済みであること

## 4. よく使う操作
### 4.1 endpoint の確認
```bash
gwcd q gateway endpoints
```

### 4.2 ダウンロード（復元）
```bash
gwcd q gateway download index.html --project my-project --save-dir /tmp
```

### 4.3 Webホスティング（HTTP）
```text
GET http://<GWCの公開URL>/render/<project>/<version>/<path>
```

※公開URL は NodePort / port-forward / Ingress 構成に依存。

## 5. 失敗したとき
- `endpoints` が空：接続/登録が未完（Deploy Guide を参照）
- manifest が取れない：MDSC にデータがない/プロジェクト名違い
- fragment が欠損：FDSC 側欠損、あるいは endpoint 解決が誤り

→ 詳細は `08_runbook.md` を参照。

## 6. 開発者向け Tips（コントローラ実装）
クライアントやコントローラを自作・拡張する際の重要な仕様・注意点です。

### 6.1 WebSocket 接続時のヘルスチェック（必須）
GWC などのノードに対し WebSocket (`ws://.../websocket`) で接続する場合、接続直後に **JSON-RPC status** コールなどの通信を行わないと、処理がスタックする（レスポンスが降りてこない）現象が確認されています。

```typescript
// 例: 接続直後のヘルスチェック
const healthCheckQuery = {
  jsonrpc: "2.0",
  method: "status",
  id: `healthcheck-${Date.now()}`,
  params: {}
};
await wsClient.execute(healthCheckQuery);
```

### 6.2 ガス代シミュレーションの係数
トランザクションのガス見積もり (`simulate`) は、「実際に消費される量」ギリギリを返すことがあります。
特にチャンク分割アップロードのような連続トランザクションでは、わずかな変動でガス不足 (`out of gas`) になりやすいため、余裕を持たせてください。

- **推奨係数**: シミュレーション値 × **1.5**

## 7. 卒研への導線
- 実験の全体設計：`09_experiment_handbook.md`
- 実験手順テンプレ：`10_experiment_protocol_template.md`
